<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Doğum Günün Kutlu Olsun Aşkım 💞</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#ff1493;
      --bg1:#ffe6f0;
      --bg2:#ff99cc;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:'Quicksand',sans-serif;
      background:radial-gradient(circle at center,var(--bg1),var(--bg2),#ff66b2);
      color:#000;
      overflow-x:hidden;
      text-align:center;
    }

    /* Intro / Start button */
    #introScreen{
      position:fixed; inset:0; z-index:9999;
      display:flex; align-items:center; justify-content:center; flex-direction:column;
      gap:14px;
      background: radial-gradient(circle at center,#ffb6c1,#ff66b2,#ff1493);
      color:white;
      transition:opacity 1s ease, visibility 1s;
    }
    .introContent h2{font-size:2rem; margin:0; text-shadow:0 0 12px rgba(255,255,255,0.9)}
    .introContent p{margin:6px 0 0 0; font-size:1.1rem; text-shadow:0 0 8px rgba(255,255,255,0.7)}

    #startBtn{
      margin-top:12px;
      background:linear-gradient(90deg,#ff699f,#ff2e7a);
      border:none;
      color:white;
      padding:18px 22px;
      border-radius:999px;
      font-size:1.2rem;
      cursor:pointer;
      box-shadow:0 12px 40px rgba(255,20,147,0.35);
      transition:all .9s cubic-bezier(.2,.9,.2,1);
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    #startBtn.move-to-top {
      position:fixed;
      left:15px;
      top:15px;
      width:50px;
      height:50px;
      padding:0;
      border-radius:50%;
      font-size:1.2rem;
      transform:none;
      box-shadow:0 8px 24px rgba(0,0,0,0.12);
      z-index:10001;
    }

    /* Controls */
    #controls{
      position:fixed;
      top:15px;
      left:15px;
      display:none;
      gap:12px;
      align-items:center;
      z-index:10000;
    }
    .iconButton{
      background:rgba(255,255,255,0.28);
      border:2px solid rgba(255,255,255,0.6);
      width:50px;height:50px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;color:white;font-size:1.3rem;
      cursor:pointer;backdrop-filter:blur(6px);box-shadow:0 6px 18px rgba(255,20,147,0.25);
      transition:transform .2s;
    }
    .iconButton:active{ transform:scale(.96) }
    .glowText{ color:white; font-size:.95rem; text-shadow:0 0 8px rgba(255,255,255,0.8); }

    /* Title */
    h1{
      margin-top:40px;
      font-size:2.6rem;
      color:#2b2b2b;
      text-shadow:0 0 12px rgba(255,255,255,0.8);
      animation: fadeIn 1.6s ease both, heartbeat 2.2s ease-in-out infinite;
      transform-origin:center;
    }
    @keyframes fadeIn { from{opacity:0; transform:translateY(20px)} to{opacity:1; transform:translateY(0)} }
    @keyframes heartbeat {0%,100%{transform:scale(1)}30%{transform:scale(1.06)}50%{transform:scale(1)}70%{transform:scale(1.08)}}

    /* 🌼 Video + papatya çerçevesi */
    #videoFrame {
      position: relative;
      display: inline-block;
      margin: 30px auto;
      width: 90%;
      max-width: 480px;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(255, 182, 193, 0.6);
    }

    #videoFrame iframe {
      width: 100%;
      height: 270px;
      border: 0;
      display: block;
      border-radius: 24px;
    }

    /* Transparent overlay that captures the user's first intent to play the video.
       We remove it after the first intentional click so iframe receives interactions. */
    #videoOverlay {
      position: absolute;
      inset: 0;
      z-index: 1100;
      background: transparent;
      cursor: pointer;
      /* accessibility */
    }

    .flower {
      position: absolute;
      font-size: 1.6rem;
      animation: floatFlower 6s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes floatFlower {
      0%,100% { transform: scale(1) rotate(0deg); opacity: 1; }
      50% { transform: scale(1.2) rotate(10deg); opacity: 0.9; }
    }

    .top-left    { top: -10px; left: -10px; }
    .top-right   { top: -10px; right: -10px; }
    .bottom-left { bottom: -10px; left: -10px; }
    .bottom-right{ bottom: -10px; right: -10px; }
    .top-center  { top: -10px; left: 50%; transform: translateX(-50%); }
    .bottom-center{ bottom: -10px; left: 50%; transform: translateX(-50%); }
    .left-center { left: -10px; top: 50%; transform: translateY(-50%); }
    .right-center{ right: -10px; top: 50%; transform: translateY(-50%); }

    /* Message */
    .message{
      margin:30px auto; font-size:1.15rem; line-height:1.7;
      background:rgba(255,255,255,0.55); padding:20px; border-radius:20px; max-width:92%;
      box-shadow:0 8px 24px rgba(255,255,255,0.4);
      opacity:0; transform:translateY(8px); transition:all .7s ease;
    }
    .message.show{ opacity:1; transform:translateY(0) }

    #bigMessage{
      margin-top:30px; font-size:1.8rem; font-weight:700; color:#2b2b2b;
      background:rgba(255,255,255,0.45); padding:18px; border-radius:24px; display:inline-block; opacity:0;
    }
    #bigMessage.show{ opacity:1; animation: slideDown 1s ease forwards }
    @keyframes slideDown { from{ transform:translateY(-20px); opacity:0 } to{ transform:translateY(0); opacity:1 } }

    .emoji{ position:fixed; bottom:-50px; font-size:2rem; animation:flyUp 6s linear forwards; z-index:9000; pointer-events:none }
    @keyframes flyUp { 0%{transform:translateY(0) scale(1); opacity:1} 100%{transform:translateY(-900px) scale(1.6); opacity:0} }

    #musicStarted {
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      background:rgba(255,255,255,0.8);
      padding:20px 30px;
      border-radius:20px;
      font-size:1.4rem;
      color:#ff1493;
      box-shadow:0 0 20px rgba(255,20,147,0.5);
      opacity:0;
      transition:opacity 0.6s ease;
      z-index:9000;
    }

    /* responsive */
    @media(max-width:768px){
      h1{ font-size:2.1rem; margin-top:28px }
      #videoFrame iframe{ height:220px }
      .flower { font-size: 1.3rem; }
      #startBtn.move-to-top{ left:10px; top:10px; width:46px; height:46px }
      #controls{ left:10px; top:10px }
    }
  </style>
</head>
<body>

  <!-- Intro -->
  <div id="introScreen">
    <div class="introContent">
      <h2>💞 Hoş Geldin Aşkım 💞</h2>
      <p>Müziği başlatmak için kalbe dokun 💖</p>
      <button id="startBtn">❤️</button>
    </div>
  </div>

  <!-- Music started text -->
  <div id="musicStarted">🎶 Müzik Başladı 🎶</div>

  <!-- Controls -->
  <div id="controls">
    <button id="musicBtn" class="iconButton">🔈</button>
    <div id="musicText" class="glowText">Müziği Durdur</div>
  </div>

  <h1 id="title">💖 Doğum Günün Kutlu Olsun Aşkım 💖</h1>

  <!-- 🌼 Papatya çerçeveli video -->
  <div id="videoFrame">
    <iframe id="ytiframe" src="https://www.youtube.com/embed/sr7PADgCNP0?rel=0&enablejsapi=1"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    <!-- overlay captures the user's intent to play the video and lets us pause music safely.
         it will be removed after first intentional click and then we programmatically start video via player.playVideo() -->
    <div id="videoOverlay" aria-hidden="true"></div>

    <div class="flower top-left">🌼</div>
    <div class="flower top-center">🌼</div>
    <div class="flower top-right">🌼</div>
    <div class="flower bottom-left">🌼</div>
    <div class="flower bottom-center">🌼</div>
    <div class="flower bottom-right">🌼</div>
    <div class="flower left-center">🌼</div>
    <div class="flower right-center">🌼</div>
  </div>

  <div class="message" id="loveMessage">
    Bu özel gününde, seni ne kadar çok sevdiğimi bir kez daha hatırlatmak istedim. 💕  
    Sen benim hayatımın en güzel parçasısın 💞  
    Doğum günün kutlu olsun bir tanem 🎂  
    Nice mutlu, sağlıklı ve aşk dolu yıllarımız olsun 💫  
  </div>

  <div id="bigMessage">💞 SENİ ÇOK SEVİYORUM AŞKIM 💞<br>🎂 DOĞUM GÜNÜN KUTLU OLSUN 🎂</div>

  <audio id="bgMusic" loop preload="auto">
    <source src="music.mp3" type="audio/mpeg">
  </audio>

<script>
const intro = document.getElementById('introScreen');
const startBtn = document.getElementById('startBtn');
const controls = document.getElementById('controls');
const musicBtn = document.getElementById('musicBtn');
const musicText = document.getElementById('musicText');
const music = document.getElementById('bgMusic');
const yt = document.getElementById('ytiframe');
const loveMessage = document.getElementById('loveMessage');
const bigMessage = document.getElementById('bigMessage');
const musicStarted = document.getElementById('musicStarted');
const videoOverlay = document.getElementById('videoOverlay');

let isPlaying = false;
let emojiInterval = null;
let ytPlayerReady = false;
window.player = null; // will hold YT player instance

/* Play music from 10s */
async function tryPlayAt(sec){
  try { music.currentTime = sec; } catch(e){}
  try {
    await music.play();
    isPlaying = true;
    // update UI if controls shown
    if (musicBtn) musicBtn.textContent = '🔈';
    if (musicText) musicText.textContent = 'Müziği Durdur';
  } catch (err) { console.warn(err); }
}

/* Move button and show controls */
function animateStartToControls(){
  startBtn.classList.add('move-to-top');
  setTimeout(()=>{ controls.style.display = 'flex'; startBtn.remove(); }, 850);
}

/* Show words one by one */
function showMessageWords(){
  loveMessage.classList.add('show');
  const text = loveMessage.textContent.trim();
  loveMessage.textContent = '';
  const words = text.split(' ');
  words.forEach((w, i) => {
    const span = document.createElement('span');
    span.textContent = w + ' ';
    span.style.opacity = '0';
    span.style.display = 'inline-block';
    span.style.marginRight = '4px';
    span.style.transition = 'opacity 0.6s ease';
    loveMessage.appendChild(span);
    setTimeout(() => span.style.opacity = '1', i * 280);
  });
}

/* Emojis */
const emojis = ["💖","💞","💘","💝","💋","❤️","🩷","💕","💓","💗","💜","💙","🎂","🎉","✨","🌈","🌹"];
function startEmojis(){
  if(emojiInterval) return;
  emojiInterval = setInterval(()=>{
    const el = document.createElement('div');
    el.className = 'emoji';
    el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    el.style.left = Math.random()*100 + 'vw';
    el.style.fontSize = (1 + Math.random()*1.6) + 'rem';
    document.body.appendChild(el);
    setTimeout(()=> el.remove(), 6200);
  }, 200);
}

/* utility: stop music and sync UI */
function stopMusicSafely(){
  if(isPlaying){
    music.pause();
    isPlaying = false;
    if (musicBtn) musicBtn.textContent = '🔊';
    if (musicText) musicText.textContent = 'Müziği Devam Ettir';
  }
}

/* Start button click */
startBtn.addEventListener('click', async ()=>{
  await tryPlayAt(10);
  musicStarted.style.opacity = '1';
  setTimeout(()=> musicStarted.style.opacity = '0', 1500);
  animateStartToControls();
  intro.style.opacity = '0';
  setTimeout(()=> intro.remove(), 900);
  setTimeout(()=>{
    showMessageWords();
    startEmojis();
    setTimeout(()=> bigMessage.classList.add('show'), 2200);
  }, 600);
});

/* Music control (manual) */
musicBtn.addEventListener('click', async ()=>{
  if(isPlaying){
    music.pause();
    isPlaying = false;
    musicBtn.textContent = '🔊';
    musicText.textContent = 'Müziği Devam Ettir';
  } else {
    await tryPlayAt(music.currentTime || 10);
  }
});

/* VIDEO overlay handling:
   - overlay captures first "intent to play" (click/touch)
   - it stops the music (if playing), updates UI, then removes itself
   - it also attempts to start the actual YouTube player via API for a smooth UX
*/
videoOverlay.addEventListener('click', async (e) => {
  // prevent accidental long-press context menus
  e.preventDefault();
  // stop background music and sync UI
  stopMusicSafely();

  // remove overlay so iframe becomes interactive after this
  try { videoOverlay.remove(); } catch(e){}

  // if YT player ready, start the video programmatically
  if (window.player && typeof window.player.playVideo === 'function') {
    try {
      window.player.playVideo();
    } catch (err) {
      // ignore — user can tap iframe to start if API couldn't
      console.warn('player.playVideo() failed', err);
    }
  }
}, {passive:false});

/* Fallback: user may trigger playback inside iframe (or via keyboard). Use YouTube Player API to detect actual playback start. */
function onYouTubeIframeAPIReady() {
  window.player = new YT.Player('ytiframe', {
    events: {
      'onReady': function(){ ytPlayerReady = true; },
      'onStateChange': function(event) {
        // 1 = PLAYING
        if (event.data === 1) {
          // when video actually starts playing, ensure music stopped & UI synced
          stopMusicSafely();
        }
      }
    }
  });
}

/* Load YouTube Player API */
(function loadYouTubeAPI(){
  const tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);
})();

/* Pause background music when user taps inside the iframe area in other ways:
   also listen for pointerdown on iframe wrapper (as an extra fallback)
*/
yt.addEventListener('pointerdown', (e)=>{
  // only act if overlay was already removed (i.e. user interacting directly with iframe)
  if (!document.getElementById('videoOverlay')) {
    stopMusicSafely();
  }
});

/* accessibility: allow Enter/Space to trigger start */
startBtn.addEventListener('keydown', async (e) => {
  if(e.key === 'Enter' || e.key === ' ') {
    e.preventDefault();
    startBtn.click();
  }
});

/* cleanup on unload */
window.addEventListener('beforeunload', ()=> {
  if(emojiInterval) clearInterval(emojiInterval);
});
</script>
</body>
</html>
